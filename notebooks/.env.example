# ================================
# Azure Monitor Ingestion Configuration
# ================================
# Get these values from Terraform outputs:
#   cd infra/terraform
#   terraform output -json

# Data Collection Endpoint (DCE)
AZURE_MONITOR_DCE_ENDPOINT=https://dce-fabric-monitoring-xxxx.canadacentral-1.ingest.monitor.azure.com

# Data Collection Rule (DCR) - Spark Monitoring
AZURE_MONITOR_DCR_IMMUTABLE_ID=dcr-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Stream Names (must match DCR configuration)
AZURE_MONITOR_STREAM_LIVY_SESSION=Custom-FabricSparkLivySession_CL
AZURE_MONITOR_STREAM_SPARK_LOGS=Custom-FabricSparkLogs_CL
AZURE_MONITOR_STREAM_HISTORY_METRICS=Custom-FabricSparkHistoryMetrics_CL
AZURE_MONITOR_STREAM_RESOURCE_USAGE=Custom-FabricSparkResourceUsage_CL

# Log Analytics Workspace
LOG_ANALYTICS_WORKSPACE_NAME=law-fabric-monitoring
LOG_ANALYTICS_RESOURCE_GROUP=rg-fabric-monitoring

# ================================
# Azure Authentication
# ================================
# These are automatically populated from Terraform outputs
AZURE_TENANT_ID=your-tenant-id-here
AZURE_SUBSCRIPTION_ID=your-subscription-id-here

# Optional: For service principal authentication
# If not set, DefaultAzureCredential will use Azure CLI (az login)
# AZURE_CLIENT_ID=your-app-id-here
# AZURE_CLIENT_SECRET=your-app-secret-here

# ================================
# Fabric Workspace Configuration
# ================================
# Required for data collection
FABRIC_WORKSPACE_ID=your-workspace-id-here
FABRIC_WORKSPACE_NAME=your-workspace-name-here
FABRIC_TENANT_ID=your-tenant-id-here

# Fabric App Registration (for Fabric API authentication)
FABRIC_APP_ID=your-fabric-app-id-here
FABRIC_APP_SECRET=your-fabric-app-secret-here

# ================================
# Collection Configuration (Optional)
# ================================
FABRIC_LOOKBACK_HOURS=24
FABRIC_COLLECT_ACTIVITY_RUNS=true
FABRIC_METRICS_INTERVAL_MINUTES=15
FABRIC_RUNTIME_VERSION=1.3

# Capacity Monitoring (comma-separated for multiple capacities)
FABRIC_CAPACITY_IDS=capacity-guid-1,capacity-guid-2

# ================================
# Key Vault Configuration (Optional)
# ================================
# SECURITY: Never hardcode Key Vault URI - always use environment variables
AZURE_KEY_VAULT_URI=https://your-keyvault-name.vault.azure.net/
AZURE_KEY_VAULT_SECRET_NAME=FabricServicePrincipal

# ================================
# Quick Setup Instructions
# ================================
# 1. Deploy infrastructure:
#    cd infra/terraform
#    terraform apply
#
# 2. Get Terraform outputs:
#    terraform output -json > outputs.json
#
# 3. Copy values to this file:
#    - AZURE_MONITOR_DCE_ENDPOINT from: data_collection_endpoint_logs_ingestion_endpoint
#    - AZURE_MONITOR_DCR_IMMUTABLE_ID from: dcr_spark_immutable_id
#    - LOG_ANALYTICS_WORKSPACE_NAME from: log_analytics_workspace_name
#    - AZURE_TENANT_ID from: tenant_id
#
# 4. Authenticate with Azure:
#    az login
#
# 5. Test ingestion:
#    Open test_ingestion.ipynb and run all cells
